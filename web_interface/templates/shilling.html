{% extends "base.html" %}

{% block title %}–®–∏–ª—ñ–Ω–≥ - Twitter Bot Control{% endblock %}

{% block page_title %}–°–∏—Å—Ç–µ–º–∞ –®–∏–ª—ñ–Ω–≥—É{% endblock %}

{% block content %}
<div class="shilling-container">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞ –æ–ø–∏—Å -->
    <div class="section-header">
        <h2><i class="fas fa-rocket"></i> –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç–∞–º–∏ —à–∏–ª—ñ–Ω–≥—É</h2>
        <p>–°—Ç–≤–æ—Ä—é–π—Ç–µ —Ç–∞ –Ω–∞–ª–∞—à—Ç–æ–≤—É–π—Ç–µ –ø—Ä–æ—î–∫—Ç–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–æ–±–æ—Ç–∏ –∑ Twitter –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</p>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –≥—Ä—É–ø–∏ -->
    <div class="create-group-section">
        <button class="btn btn-primary" onclick="openCreateGroupModal()">
            <i class="fas fa-plus"></i> –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç
        </button>
            </div>

    <!-- –°–ø–∏—Å–æ–∫ —ñ—Å–Ω—É—é—á–∏—Ö –≥—Ä—É–ø -->
    <div class="groups-list-section">
        <h3><i class="fas fa-list"></i> –Ü—Å–Ω—É—é—á—ñ –ø—Ä–æ—î–∫—Ç–∏</h3>
        <div class="groups-grid" id="groups-grid">
            <!-- –ì—Ä—É–ø–∏ –±—É–¥—É—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è/—Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –≥—Ä—É–ø–∏ -->
    <div id="groupModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç</h3>
                <span class="close" onclick="closeGroupModal()">&times;</span>
            </div>
            
            <form id="groupForm" class="group-form" method="post" action="javascript:void(0);">
                <div class="form-group">
                    <label for="groupName">–ù–∞–∑–≤–∞ –ø—Ä–æ—î–∫—Ç—É *</label>
                    <input type="text" id="groupName" name="groupName" required 
                           placeholder="–í–≤–µ–¥—ñ—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω—É –Ω–∞–∑–≤—É –ø—Ä–æ—î–∫—Ç—É">
            </div>

                <!-- Google —Ç–∞–±–ª–∏—Ü—ñ -->
                <div class="form-section">
                    <h4><i class="fas fa-table"></i> Google —Ç–∞–±–ª–∏—Ü—ñ</h4>
                    
                    <div class="form-group">
                        <label for="accountsGoogleSheet">–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ Google-—Ç–∞–±–ª–∏—Ü—é –∑ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ *</label>
                        <input type="url" id="accountsGoogleSheet" name="accountsGoogleSheet" required 
                               placeholder="https://docs.google.com/spreadsheets/d/...">
                        <small>–¢–∞–±–ª–∏—Ü—è –ø–æ–≤–∏–Ω–Ω–∞ –º–∞—Ç–∏ —Ñ–æ—Ä–º–∞—Ç —è–∫ —É —Ñ—É–Ω–∫—Ü—ñ—ó googletable</small>
                    </div>

                    <div class="form-group">
                        <label for="logsGoogleSheet">–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ Google-—Ç–∞–±–ª–∏—Ü—é –¥–ª—è –∑–≤—ñ—Ç—ñ–≤ *</label>
                        <input type="url" id="logsGoogleSheet" name="logsGoogleSheet" required 
                               placeholder="https://docs.google.com/spreadsheets/d/...">
                        <small>–¢–∞–±–ª–∏—Ü—è –¥–ª—è –∑–∞–ø–∏—Å—É –∑–≤—ñ—Ç—ñ–≤ –¥—ñ–π –ø—Ä–æ—î–∫—Ç—É</small>
                    </div>
                </div>

                <div class="form-section">
                    <h4>–ó–∞—Ç—Ä–∏–º–∫–∏ –º—ñ–∂ –¥—ñ—è–º–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)</h4>
                    
                    <div class="inline-fields-grid">
                        <div class="inline-field-group">
                            <span class="field-label">–ú—ñ–∂ –¥—ñ—è–º–∏ (–º—ñ–Ω)</span>
                            <input type="number" id="delayBetweenActionsMin" name="delayBetweenActionsMin" 
                                   value="120" step="1" required class="inline-input">
                            <span class="field-label">(–º–∞–∫—Å)</span>
                            <input type="number" id="delayBetweenActionsMax" name="delayBetweenActionsMax" 
                                   value="300" step="1" required class="inline-input">
                        </div>
                        
                        <div class="inline-field-group">
                            <span class="field-label">–ú—ñ–∂ –ª–∞–π–∫–∞–º–∏ (–º—ñ–Ω)</span>
                            <input type="number" id="delayBetweenLikesMin" name="delayBetweenLikesMin" 
                                   value="60" step="1" required class="inline-input">
                            <span class="field-label">(–º–∞–∫—Å)</span>
                            <input type="number" id="delayBetweenLikesMax" name="delayBetweenLikesMax" 
                                   value="180" step="1" required class="inline-input">
                        </div>
                        
                        <div class="inline-field-group">
                            <span class="field-label">–ú—ñ–∂ —Ä–µ—Ç–≤—ñ—Ç–∞–º–∏ (–º—ñ–Ω)</span>
                            <input type="number" id="delayBetweenRetweetsMin" name="delayBetweenRetweetsMin" 
                                   value="300" step="1" required class="inline-input">
                            <span class="field-label">(–º–∞–∫—Å)</span>
                            <input type="number" id="delayBetweenRetweetsMax" name="delayBetweenRetweetsMax" 
                                   value="600" step="1" required class="inline-input">
                        </div>

                        <div class="inline-field-group">
                            <span class="field-label">–ú—ñ–∂ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏ (–º—ñ–Ω)</span>
                            <input type="number" id="delayBetweenCommentsMin" name="delayBetweenCommentsMin" 
                                   value="180" step="1" required class="inline-input">
                            <span class="field-label">(–º–∞–∫—Å)</span>
                            <input type="number" id="delayBetweenCommentsMax" name="delayBetweenCommentsMax" 
                                   value="420" step="1" required class="inline-input">
                        </div>
                        
                        <div class="inline-field-group">
                            <span class="field-label">–ú—ñ–∂ –ø–æ—Å—Ç–∞–º–∏ (–º—ñ–Ω)</span>
                            <input type="number" id="delayBetweenPostsMin" name="delayBetweenPostsMin" 
                                   value="1800" step="1" required class="inline-input">
                            <span class="field-label">(–º–∞–∫—Å)</span>
                            <input type="number" id="delayBetweenPostsMax" name="delayBetweenPostsMax" 
                                   value="3600" step="1" required class="inline-input">
                        </div>
                    </div>
                </div>





                <!-- –ù–û–í–Ü –§–Ü–õ–¨–¢–†–ò: –ö–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–∞ —Ñ–æ—Ä–º–∞—Ç –ø–æ—à—É–∫—É -->
                <div class="form-section">
                    <h4><i class="fas fa-images"></i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ —Ç–∞ –ø–æ—à—É–∫—É</h4>
                    
                    <div class="form-group">
                        <label for="useImages">–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏</label>
                        <select id="useImages" name="useImages">
                            <option value="no">–ù—ñ</option>
                            <option value="yes">–¢–∞–∫</option>
                        </select>
                        <small>–ß–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–æ –ø–æ—Å—Ç—ñ–≤</small>
                    </div>
                    
                    <div class="form-group" id="imagesFolderGroup" style="display: none;">
                        <label for="imagesFolder">–ü–∞–ø–∫–∞ Google Drive –∑ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏</label>
                        <input type="url" id="imagesFolder" name="imagesFolder" 
                               placeholder="https://drive.google.com/drive/folders/...">
                        <small>–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ø–∞–ø–∫—É Google Drive –∑ –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ –¥–ª—è –ø–æ—Å—Ç—ñ–≤</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="searchFormat">–§–æ—Ä–º–∞—Ç –ø–æ—à—É–∫—É –ø–æ—Å—Ç—ñ–≤</label>
                        <select id="searchFormat" name="searchFormat">
                            <option value="twitter_search">–ó–≤–∏—á–∞–π–Ω–∏–π Twitter –ø–æ—à—É–∫</option>
                            <option value="accounts_table">–ü–æ –∞–∫–∞—É–Ω—Ç–∞–º —ñ–∑ Google —Ç–∞–±–ª–∏—Ü—ñ</option>
                        </select>
                        <small>–Ø–∫ —à—É–∫–∞—Ç–∏ –ø–æ—Å—Ç–∏: —á–µ—Ä–µ–∑ Twitter –ø–æ—à—É–∫ –∞–±–æ –ø–æ –∞–∫–∞—É–Ω—Ç–∞–º –∑ —Ç–∞–±–ª–∏—Ü—ñ</small>
                    </div>
                </div>

                <!-- –ù–û–í–Ü –§–Ü–õ–¨–¢–†–ò: –§—ñ–ª—å—Ç—Ä–∏ –ø–æ—à—É–∫—É –ø–æ—Å—Ç—ñ–≤ -->
                <div class="form-section">
                    <h4><i class="fas fa-filter"></i> –§—ñ–ª—å—Ç—Ä–∏ –ø–æ—à—É–∫—É –ø–æ—Å—Ç—ñ–≤</h4>
                    
                    <div class="delays-grid">
                        <div class="form-group compact">
                            <label for="minFollowers">–ú—ñ–Ω. –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏</label>
                            <input type="number" id="minFollowers" name="minFollowers" 
                                   value="500" min="0" step="100">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="minLikes">–ú—ñ–Ω. –ª–∞–π–∫–∏</label>
                            <input type="number" id="minLikes" name="minLikes" 
                                   value="10" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="minReposts">–ú—ñ–Ω. —Ä–µ–ø–æ—Å—Ç–∏</label>
                            <input type="number" id="minReposts" name="minReposts" 
                                   value="3" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="minReplies">–ú—ñ–Ω. –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ</label>
                            <input type="number" id="minReplies" name="minReplies" 
                                   value="2" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="searchHours">–ü–æ—à—É–∫ (–≥–æ–¥–∏–Ω–∏)</label>
                            <input type="number" id="searchHours" name="searchHours" 
                                   value="12" min="1" max="168" step="1">
                            <small>–ó–∞ —Å–∫—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –≥–æ–¥–∏–Ω —à—É–∫–∞—Ç–∏ –ø–æ—Å—Ç–∏ (1-168)</small>
                        </div>
                    </div>
                    

                </div>



                <!-- –ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ—à—É–∫—É -->
                <div class="form-section">
                    <h4><i class="fas fa-search"></i> –ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ—à—É–∫—É</h4>
                    
                    <div class="form-group">
                        <label for="postTopics">–û—Å–Ω–æ–≤–Ω—ñ –°–ª–æ–≤–∞/–°–ª–æ–≤–æ—Å–ø–æ–ª—É—á–µ–Ω–Ω—è –¥–ª—è –ø–æ—à—É–∫—É –≤ —Ç–µ–∫—Å—Ç—ñ –ø–æ—Å—Ç—ñ–≤</label>
                        <input type="text" id="postTopics" name="postTopics" 
                               value="cryptocurrency analysis, blockchain technology, DeFi protocols, crypto trading, market predictions, Bitcoin news, Ethereum updates"
                               placeholder="cryptocurrency, blockchain, DeFi, trading">
                        <small>–í–≤–µ–¥—ñ—Ç—å —á–µ—Ä–µ–∑ –∫–æ–º—É –¥–ª—è —Å–ª–æ–≤–∞/—Å–ª–æ–≤–∞—Å–ø–æ–ª—É—á–µ–Ω–Ω—è —â–æ –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤ —Ç–µ–∫—Å—Ç—ñ –ø–æ—Å—Ç–∞</small>
                    </div>

                    <div class="form-group">
                        <label for="searchKeywords">–ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ—à—É–∫—É –ø–æ—Å—Ç—ñ–≤</label>
                        <input type="text" id="searchKeywords" name="searchKeywords" 
                               value="Bitcoin, BTC, Ethereum, ETH, crypto, blockchain, DeFi, Web3, altcoins, hodl, pump, moon, bull run, bear market"
                               placeholder="Bitcoin, BTC, Ethereum, ETH, crypto, blockchain, DeFi, Web3">
                        <small>–í–≤–µ–¥—ñ—Ç—å —á–µ—Ä–µ–∑ –∫–æ–º—É –¥–ª—è –ø–æ—à—É–∫—É –ø–æ—Å—Ç—ñ–≤ –¥–ª—è –ª–∞–π–∫—ñ–≤, —Ä–µ—Ç–≤—ñ—Ç—ñ–≤ —Ç–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤</small>
                    </div>
                </div>

                <!-- –ù–û–í–Ü –§–Ü–õ–¨–¢–†–ò: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ -->
                <div class="form-section">
                    <h4><i class="fas fa-comments"></i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤</h4>
                    
                    <div class="delays-grid">
                        <div class="form-group compact">
                            <label for="commentsTotalLimit">–ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å</label>
                            <input type="number" id="commentsTotalLimit" name="commentsTotalLimit" 
                                   value="500" min="1" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentsDailyLimit">–ù–∞ –¥–µ–Ω—å</label>
                            <input type="number" id="commentsDailyLimit" name="commentsDailyLimit" 
                                   value="15" min="1" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentsHourlyLimit">–ù–∞ –≥–æ–¥–∏–Ω—É</label>
                            <input type="number" id="commentsHourlyLimit" name="commentsHourlyLimit" 
                                   value="3" min="1" step="1">
                        </div>
                    </div>
                    
                    <div class="delays-grid">
                        <div class="form-group compact">
                            <label for="commentsPerPostMin">–ù–∞ –ø–æ—Å—Ç (–º—ñ–Ω)</label>
                            <input type="number" id="commentsPerPostMin" name="commentsPerPostMin" 
                                   value="1" min="1" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentsPerPostMax">(–º–∞–∫—Å)</label>
                            <input type="number" id="commentsPerPostMax" name="commentsPerPostMax" 
                                   value="2" min="1" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentIntervalMin">–Ü–Ω—Ç–µ—Ä–≤–∞–ª (–º—ñ–Ω)</label>
                            <input type="number" id="commentIntervalMin" name="commentIntervalMin" 
                                   value="300" min="1" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentIntervalMax">(–º–∞–∫—Å)</label>
                            <input type="number" id="commentIntervalMax" name="commentIntervalMax" 
                                   value="600" min="1" step="1">
                        </div>
                    </div>
                    
                    <div class="delays-grid">
                        <div class="form-group compact">
                            <label for="commentLikesMin">–õ–∞–π–∫–∏ (–º—ñ–Ω)</label>
                            <input type="number" id="commentLikesMin" name="commentLikesMin" 
                                   value="5" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentLikesMax">(–º–∞–∫—Å)</label>
                            <input type="number" id="commentLikesMax" name="commentLikesMax" 
                                   value="20" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentRepostsMin">–†–µ–ø–æ—Å—Ç–∏ (–º—ñ–Ω)</label>
                            <input type="number" id="commentRepostsMin" name="commentRepostsMin" 
                                   value="3" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentRepostsMax">(–º–∞–∫—Å)</label>
                            <input type="number" id="commentRepostsMax" name="commentRepostsMax" 
                                   value="10" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentViewsMin">–ü–µ—Ä–µ–≥–ª—è–¥–∏ (–º—ñ–Ω)</label>
                            <input type="number" id="commentViewsMin" name="commentViewsMin" 
                                   value="100" min="0" step="1">
                        </div>
                        
                        <div class="form-group compact">
                            <label for="commentViewsMax">(–º–∞–∫—Å)</label>
                            <input type="number" id="commentViewsMax" name="commentViewsMax" 
                                   value="500" min="0" step="1">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="commentPrompt">–ü—Ä–æ–º–ø—Ç –¥–ª—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤</label>
                        <textarea id="commentPrompt" name="commentPrompt" rows="3" 
                                    placeholder="Create a short, emotional response about cryptocurrencies and blockchain technology. Support or add to the author's idea. Use modern crypto slang: HODL, moon, diamond hands, bull run. Maximum 50 characters.">Create a short, emotional response about cryptocurrencies and blockchain technology. Support or add to the author's idea. Use modern crypto slang: HODL, moon, diamond hands, bull run. Maximum 50 characters.</textarea>
                            <small>–ü—Ä–æ–º–ø—Ç + —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ = –≥–æ—Ç–æ–≤–∏–π –∫–æ–º–µ–Ω—Ç–∞—Ä</small>
                    </div>
                </div>

                <!-- –ù–û–í–Ü –§–Ü–õ–¨–¢–†–ò: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ—Å—Ç—ñ–≤ -->
                <div class="form-section">
                    <h4><i class="fas fa-retweet"></i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ—Å—Ç—ñ–≤ –∑ –∫–æ–º–µ–Ω—Ç–∞—Ä–µ–º</h4>
                    
                    <div class="form-group">
                        <label for="useReposts">–†–æ–±–∏—Ç–∏ —Ä–µ–ø–æ—Å—Ç–∏ –∑ –∫–æ–º–µ–Ω—Ç–∞—Ä–µ–º</label>
                        <select id="useReposts" name="useReposts">
                            <option value="no">–ù—ñ</option>
                            <option value="yes">–¢–∞–∫</option>
                        </select>
                        <small>–†–µ—Ç–≤—ñ—Ç –∑ —Ü–∏—Ç–∞—Ç–æ—é —Ç–∏–º –∂–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º —â–æ –π –∫–æ–º–µ–Ω—Ç–∞—Ä</small>
                    </div>
                    
                    <div class="form-group" id="repostSettingsGroup" style="display: none;">
                        <label for="repostPercentage">–í—ñ–¥—Å–æ—Ç–æ–∫ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ —Ä–µ–ø–æ—Å—Ç—É</label>
                        <input type="number" id="repostPercentage" name="repostPercentage" 
                               value="50" min="1" max="100" step="1">
                        <small>–í—ñ–¥—Å–æ—Ç–æ–∫ –∑ —è–∫–æ—é –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é –±—É–¥–µ –∑—Ä–æ–±–ª–µ–Ω–æ —Ä–µ–ø–æ—Å—Ç</small>
                        
                        <label for="repostPrompt">–ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–ø–æ—Å—Ç—ñ–≤</label>
                        <textarea id="repostPrompt" name="repostPrompt" rows="3" 
                                  placeholder="Create a short emotional comment on a repost about cryptocurrencies...">Create a short emotional comment on this repost about cryptocurrencies. Express your admiration or support for the idea. Use emojis and crypto slang. Maximum 50 characters..</textarea>
                        <small>–ü—Ä–æ–º–ø—Ç + —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ = –≥–æ—Ç–æ–≤–∏–π —Ä–µ–ø–æ—Å—Ç</small>
                    </div>
                </div>

                <!-- –ù–û–í–Ü –§–Ü–õ–¨–¢–†–ò: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Å—Ç—ñ–≤ -->
                <div class="form-section">
                    <h4><i class="fas fa-edit"></i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Å—Ç—ñ–≤</h4>
                    
                    <div class="form-group">
                        <label for="usePosts">–†–æ–±–∏—Ç–∏ –ø–æ—Å—Ç–∏ —É —Å–µ–±–µ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ</label>
                        <select id="usePosts" name="usePosts">
                            <option value="no">–ù—ñ</option>
                            <option value="yes">–¢–∞–∫</option>
                        </select>
                        <small>–ü–æ—Å—Ç —É —Ç–æ–º—É –∂ –ø–æ—Ç–æ—Ü—ñ —â–æ –π –∫–æ–º–µ–Ω—Ç–∞—Ä</small>
                    </div>
                    
                    <div class="form-group" id="postSettingsGroup" style="display: none;">
                        <label for="postPercentage">–í—ñ–¥—Å–æ—Ç–æ–∫ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –ø–æ—Å—Ç–∞</label>
                        <input type="number" id="postPercentage" name="postPercentage" 
                               value="50" min="1" max="100" step="1">
                        <small>–í—ñ–¥—Å–æ—Ç–æ–∫ –∑ —è–∫–æ—é –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é –±—É–¥–µ –∑—Ä–æ–±–ª–µ–Ω–æ –ø–æ—Å—Ç</small>
                        
                        <label for="postPrompt">–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ—Å—Ç—ñ–≤</label>
                        <textarea id="postPrompt" name="postPrompt" rows="3" 
                                  placeholder="Create an original post about cryptocurrencies based on the trend...">Create an original post about cryptocurrencies and blockchain. Use a current topic or trend as inspiration. Add your own opinion or analysis. Use the hashtags #crypto #blockchain #Bitcoin #DeFi. Maximum 150 characters.</textarea>
                        <small>–ü—Ä–æ–º–ø—Ç + —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ = –≥–æ—Ç–æ–≤–∏–π –ø–æ—Å—Ç</small>
                    </div>
                </div>
            
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeGroupModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button type="submit" class="btn btn-primary" id="submitBtn" onclick="handleSubmitClick()">–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç</button>
            </div>
            </form>
    </div>
</div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø–µ—Ä–µ–≥–ª—è–¥—É –ª–æ–≥—ñ–≤ -->
    <div id="logsModal" class="modal">
        <div class="modal-content">
        <div class="modal-header">
                <h3 id="logsModalTitle">–ó–≤—ñ—Ç–∏ –ø—Ä–æ—î–∫—Ç—É</h3>
                <span class="close" onclick="closeLogsModal()">&times;</span>
        </div>
            
            <div class="logs-content">
                <div class="logs-info">
                    <p><strong>–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ Google —Ç–∞–±–ª–∏—Ü—é –∑ –∑–≤—ñ—Ç–∞–º–∏:</strong></p>
                    <div class="google-sheet-link">
                        <a id="logsSheetLink" href="#" target="_blank" class="btn btn-primary">
                            <i class="fas fa-external-link-alt"></i> –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é –∑–≤—ñ—Ç—ñ–≤
                        </a>
                    </div>
                    <div class="sheet-info">
                        <p><small>–ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ Google —Ç–∞–±–ª–∏—Ü—é –∑ –∑–≤—ñ—Ç–∞–º–∏ –¥—ñ–π —Ü—å–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É</small></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–æ—é -->
<script>
let currentEditingGroup = null;
let groupsData = [];
let isSubmitting = false; // –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    console.log('–°—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞, —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è...');
    
    // –î–∞—î–º–æ —á–∞—Å DOM –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏—Å—è
    setTimeout(() => {
        initializePage();
    }, 500);
});

// –õ–æ–≥—ñ–∫–∞ –¥–ª—è –ø–æ–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫
function toggleImagesFolder() {
    const useImages = document.getElementById('useImages');
    const imagesFolderGroup = document.getElementById('imagesFolderGroup');
    
    if (useImages.value === 'yes') {
        imagesFolderGroup.style.display = 'block';
    } else {
        imagesFolderGroup.style.display = 'none';
    }
}

// –õ–æ–≥—ñ–∫–∞ –¥–ª—è –ø–æ–ª—è —Ä–µ–ø–æ—Å—Ç—ñ–≤
function toggleRepostSettings() {
    const useReposts = document.getElementById('useReposts');
    const repostSettingsGroup = document.getElementById('repostSettingsGroup');
    
    if (useReposts.value === 'yes') {
        repostSettingsGroup.style.display = 'block';
    } else {
        repostSettingsGroup.style.display = 'none';
    }
}

// –õ–æ–≥—ñ–∫–∞ –¥–ª—è –ø–æ–ª—è –ø–æ—Å—Ç—ñ–≤
function togglePostSettings() {
    const usePosts = document.getElementById('usePosts');
    const postSettingsGroup = document.getElementById('postSettingsGroup');
    
    if (usePosts.value === 'yes') {
        postSettingsGroup.style.display = 'block';
    } else {
        postSettingsGroup.style.display = 'none';
    }
}

function initializePage() {
    console.log('–ü–æ—á–∞—Ç–æ–∫ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏...');
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —ñ—Å–Ω—É—é—Ç—å
    const requiredElements = [
        'groupForm',
        'groupName',
        'accountsGoogleSheet',
        'logsGoogleSheet',
        'delayBetweenActionsMin',
        'delayBetweenActionsMax',
        'delayBetweenLikesMin',
        'delayBetweenLikesMax',
        'delayBetweenRetweetsMin',
        'delayBetweenRetweetsMax',
        'delayBetweenCommentsMin',
        'delayBetweenCommentsMax',
        'delayBetweenPostsMin',
        'delayBetweenPostsMax',

        'searchKeywords',
        'postTopics',
        'useImages',
        'imagesFolder',
        'searchFormat',
        'minFollowers',
        'minLikes',
        'minReposts',
        'minReplies',
        'searchHours',
        'commentsTotalLimit',
        'commentsDailyLimit',
        'commentsHourlyLimit',
        'commentsPerPostMin',
        'commentsPerPostMax',
        'commentIntervalMin',
        'commentIntervalMax',
        'commentLikesMin',
        'commentLikesMax',
        'commentRepostsMin',
        'commentRepostsMax',
        'commentViewsMin',
        'commentViewsMax',
        'commentPrompt',
        'useReposts',
        'repostPercentage',
        'repostPrompt',
        'usePosts',
        'postPercentage',
        'postPrompt'
    ];
    
    const missingElements = [];
    for (const elementId of requiredElements) {
        const element = document.getElementById(elementId);
        if (!element) {
            missingElements.push(elementId);
        } else {
            console.log(`–ï–ª–µ–º–µ–Ω—Ç ${elementId} –∑–Ω–∞–π–¥–µ–Ω–æ:`, element);
        }
    }
    
    if (missingElements.length > 0) {
        console.error('–í—ñ–¥—Å—É—Ç–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —Ñ–æ—Ä–º–∏:', missingElements);
        showNotification('–ü–æ–º–∏–ª–∫–∞: –Ω–µ –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —Ñ–æ—Ä–º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ', 'error');
        return;
    }
    
    console.log('–í—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —Ñ–æ—Ä–º–∏ –∑–Ω–∞–π–¥–µ–Ω–æ');
    
    // –î–æ–¥–∞—Ç–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ñ–æ—Ä–º—É
    const form = document.getElementById('groupForm');
    if (form) {
        console.log('–§–æ—Ä–º–∞ –∑–Ω–∞–π–¥–µ–Ω–∞ –≤ initializePage:', form);
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —Ñ–æ—Ä–º–∞ –º–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∞—Ç—Ä–∏–±—É—Ç–∏
        if (!form.method) {
            form.method = 'post';
            console.log('–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ method = post');
        }
        if (!form.action) {
            form.action = 'javascript:void(0);';
            console.log('–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ action = javascript:void(0);');
        }
    }
    
    // –ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é —Ñ–æ—Ä–º–∏
    setupFormValidation();
    
    // –ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏
    setupAdditionalHandlers();
    
    // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –≥—Ä—É–ø–∏
    loadGroups();
    
    console.log('–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Å—Ç–∞–Ω—É –≥—Ä—É–ø–∏ (–∑–∞–ø—É—Å–∫/–∑—É–ø–∏–Ω–∫–∞)
async function toggleGroup(groupName, currentStatus) {
    try {
        const action = currentStatus ? 'stop' : 'start';
        const actionText = currentStatus ? '–∑—É–ø–∏–Ω–∫–∏' : '–∑–∞–ø—É—Å–∫—É';
        
        console.log(`üîÑ ${actionText} –≥—Ä—É–ø–∏: ${groupName}`);
        showLoadingIndicator(`${actionText} –ø—Ä–æ—î–∫—Ç—É: ${groupName}`);
        
        const response = await fetch(`/api/shilling/groups/${encodeURIComponent(groupName)}/${action}`, {
            method: 'POST'
        });
        
        if (response.ok) {
            const result = await response.json();
            if (result.success) {
                showNotification(`–ü—Ä–æ—î–∫—Ç ${groupName} —É—Å–ø—ñ—à–Ω–æ ${action === 'start' ? '–∑–∞–ø—É—â–µ–Ω–∞' : '–∑—É–ø–∏–Ω–µ–Ω–∞'}`, 'success');
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –≥—Ä—É–ø–∏ –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏
                setTimeout(() => refreshGroupStatus(groupName), 1000);
            } else {
                throw new Error(result.error || `–ü–æ–º–∏–ª–∫–∞ ${actionText} –ø—Ä–æ—î–∫—Ç—É`);
            }
        } else {
            const errorData = await response.json();
            throw new Error(errorData.error || `–ü–æ–º–∏–ª–∫–∞ ${actionText} –ø—Ä–æ—î–∫—Ç—É`);
        }
        
    } catch (error) {
        console.error(`–ü–æ–º–∏–ª–∫–∞ ${actionText} –ø—Ä–æ—î–∫—Ç—É:`, error);
        showNotification(`–ü–æ–º–∏–ª–∫–∞ ${actionText} –ø—Ä–æ—î–∫—Ç—É: ${error.message}`, 'error');
    } finally {
        hideLoadingIndicator();
    }
}

// –û–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è loadGroups –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º —Å—Ç–∞—Ç—É—Å—É
async function loadGroups() {
    try {
        const response = await fetch('/api/shilling/groups');
        if (response.ok) {
            groupsData = await response.json();
            displayGroups(groupsData);
            
            // –û–Ω–æ–≤–ª—é—î–º–æ –∫–Ω–æ–ø–∫–∏ –ø—ñ—Å–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≥—Ä—É–ø
            setTimeout(updateGroupButtons, 100);
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –≤—Å—ñ—Ö –≥—Ä—É–ø –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            setTimeout(() => {
                if (groupsData && groupsData.length > 0) {
                    groupsData.forEach(group => {
                        refreshGroupStatus(group.group_name);
                    });
                }
            }, 2000);
        } else {
            showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤', 'error');
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤:', error);
        showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤', 'error');
    }
}

// –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≥—Ä—É–ø
function displayGroups(groups) {
    const grid = document.getElementById('groups-grid');
    
    if (groups.length === 0) {
        grid.innerHTML = '<div class="no-groups"><p>–ü—Ä–æ—î–∫—Ç—ñ–≤ —â–µ –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ</p></div>';
        return;
    }
    
    grid.innerHTML = groups.map(group => `
        <div class="group-card ${group.is_running ? 'running' : 'stopped'}" data-group-name="${group.group_name}">
            <div class="group-header">
                <h4>${group.group_name}</h4>
                <div class="group-status ${group.is_running ? 'status-running' : 'status-stopped'}">
                    <i class="fas fa-${group.is_running ? 'play' : 'stop'}"></i>
                    ${group.is_running ? '–ó–∞–ø—É—â–µ–Ω–∞' : '–ó—É–ø–∏–Ω–µ–Ω–∞'}
                </div>
            </div>
            
            <div class="group-info">
                <p><strong>–°—Ç–≤–æ—Ä–µ–Ω–æ:</strong> ${formatDate(group.created_at)}</p>
                <p><strong>–û–Ω–æ–≤–ª–µ–Ω–æ:</strong> ${formatDate(group.updated_at)}</p>
            </div>
            
            <div class="group-actions">
                <button class="btn btn-sm ${group.is_running ? 'btn-warning' : 'btn-success'}" 
                        onclick="toggleGroup('${group.group_name}', ${group.is_running})">
                    <i class="fas fa-${group.is_running ? 'pause' : 'play'}"></i>
                    ${group.is_running ? '–ó—É–ø–∏–Ω–∏—Ç–∏' : '–ó–∞–ø—É—Å—Ç–∏—Ç–∏'}
                </button>
                
                <button class="btn btn-sm btn-info" onclick="viewGroupLogsAsync('${group.group_name}')">
                    <i class="fas fa-list"></i> –ó–≤—ñ—Ç–∏
                </button>
                
                <button class="btn btn-sm btn-primary" onclick="editGroupAsync('${group.group_name}')">
                    <i class="fas fa-edit"></i> –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                </button>
                
                <button class="btn btn-sm btn-danger" onclick="deleteGroup('${group.group_name}')">
                    <i class="fas fa-trash"></i> –í–∏–¥–∞–ª–∏—Ç–∏
                </button>
            </div>
        </div>
    `).join('');
}

// –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä—É–ø–∏
function openCreateGroupModal() {
    console.log('–í—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä—É–ø–∏...');
    
    try {
        const modalTitle = document.getElementById('modalTitle');
        const submitBtn = document.getElementById('submitBtn');
        const groupForm = document.getElementById('groupForm');
        const groupModal = document.getElementById('groupModal');
        
        if (!modalTitle || !submitBtn || !groupForm || !groupModal) {
            console.error('–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞');
            showNotification('–ü–æ–º–∏–ª–∫–∞: –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –µ–ª–µ–º–µ–Ω—Ç–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞', 'error');
            return;
        }
        
        currentEditingGroup = null;
        modalTitle.textContent = '–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç';
        submitBtn.textContent = '–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç';
        groupForm.reset();
        groupModal.style.display = 'block';
        
        console.log('–ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–æ');
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞:', error);
        showNotification('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞: ' + error.message, 'error');
    }
}

// –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
function closeGroupModal() {
    document.getElementById('groupModal').style.display = 'none';
    currentEditingGroup = null;
}

// –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –≥—Ä—É–ø–∏
async function editGroup(groupName) {
    try {
        console.log(`üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç—É: ${groupName}`);
        
        // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        showLoadingIndicator(`–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É: ${groupName}`);
        
        // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Promise.race –¥–ª—è —Ç–∞–π–º–∞—É—Ç—É
        const timeoutPromise = new Promise((_, reject) => 
            setTimeout(() => reject(new Error('Timeout')), 10000)
        );
        
        const fetchPromise = fetch(`/api/shilling/groups/${encodeURIComponent(groupName)}`);
        
        const response = await Promise.race([fetchPromise, timeoutPromise]);
        
        if (response.ok) {
            const groupData = await response.json();
            currentEditingGroup = groupName;
            
            // –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Ñ–æ—Ä–º—É –¥–∞–Ω–∏–º–∏
            fillFormWithGroupData(groupData);
            
            document.getElementById('modalTitle').textContent = `–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—î–∫—Ç: ${groupName}`;
            document.getElementById('submitBtn').textContent = '–û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç';
            document.getElementById('groupModal').style.display = 'block';
            
            console.log(`‚úÖ –ì—Ä—É–ø–∞ ${groupName} —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞`);
            showNotification(`–ü—Ä–æ—î–∫—Ç ${groupName} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è`, 'success');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –≥—Ä—É–ø–∏ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            setTimeout(() => refreshGroupStatus(groupName), 500);
        } else {
            const errorData = await response.json();
            throw new Error(errorData.error || '–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç—É');
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É:', error);
        
        if (error.message === 'Timeout') {
            showNotification('–¢–∞–π–º–∞—É—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.', 'warning');
        } else {
            showNotification(`–ü–æ–º–∏–ª–∫–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É: ${error.message}`, 'error');
        }
    } finally {
        // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        hideLoadingIndicator();
    }
}

// –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ –¥–∞–Ω–∏–º–∏ –≥—Ä—É–ø–∏
function fillFormWithGroupData(groupData) {
    // –ë–µ–∑–ø–µ—á–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –Ω–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
    const safeSetValue = (id, value) => {
        const element = document.getElementById(id);
        if (element && value !== undefined && value !== null) {
            element.value = value;
        }
    };
    
    const safeSetArrayValue = (id, array) => {
        const element = document.getElementById(id);
        if (element && Array.isArray(array)) {
            element.value = array.join(', ');
        }
    };
    
    const safeSetObjectValue = (id, obj, key) => {
        const element = document.getElementById(id);
        if (element && obj && obj[key] !== undefined && obj[key] !== null) {
            element.value = obj[key];
        }
    };
    
    // –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–ª—è
    safeSetValue('groupName', groupData.group_name);
    safeSetValue('accountsGoogleSheet', groupData.accounts_google_sheet);
    safeSetValue('logsGoogleSheet', groupData.logs_google_sheet);
    
    // –ó–∞—Ç—Ä–∏–º–∫–∏
    if (groupData.delays) {
        safeSetObjectValue('delayBetweenActionsMin', groupData.delays.between_actions, 'min');
        safeSetObjectValue('delayBetweenActionsMax', groupData.delays.between_actions, 'max');
        safeSetObjectValue('delayBetweenLikesMin', groupData.delays.between_likes, 'min');
        safeSetObjectValue('delayBetweenLikesMax', groupData.delays.between_likes, 'max');
        safeSetObjectValue('delayBetweenRetweetsMin', groupData.delays.between_retweets, 'min');
        safeSetObjectValue('delayBetweenRetweetsMax', groupData.delays.between_retweets, 'max');
        safeSetObjectValue('delayBetweenCommentsMin', groupData.delays.between_comments, 'min');
        safeSetObjectValue('delayBetweenCommentsMax', groupData.delays.between_comments, 'max');
        safeSetObjectValue('delayBetweenPostsMin', groupData.delays.between_posts, 'min');
        safeSetObjectValue('delayBetweenPostsMax', groupData.delays.between_posts, 'max');
    }
    

    
    // –ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ —Ç–∞ —Ç–µ–º–∏
    safeSetArrayValue('searchKeywords', groupData.search_keywords);
    safeSetArrayValue('postTopics', groupData.post_topics);
    
    // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ö–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–∞ –ø–æ—à—É–∫
    if (groupData.use_images !== undefined) {
        safeSetValue('useImages', groupData.use_images ? 'yes' : 'no');
        toggleImagesFolder(); // –û–Ω–æ–≤–ª—é—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å –ø–æ–ª—è –ø–∞–ø–∫–∏
    }
    safeSetValue('imagesFolder', groupData.images_folder);
    safeSetValue('searchFormat', groupData.search_format);
    
    // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –§—ñ–ª—å—Ç—Ä–∏ –ø–æ—à—É–∫—É
    safeSetValue('minFollowers', groupData.min_followers);
    safeSetValue('minLikes', groupData.min_likes);
    safeSetValue('minReposts', groupData.min_reposts);
    safeSetValue('minReplies', groupData.min_replies);
    safeSetValue('searchHours', groupData.search_hours);
    
    // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤
    safeSetValue('commentsTotalLimit', groupData.comments_total_limit);
    safeSetValue('commentsDailyLimit', groupData.comments_daily_limit);
    safeSetValue('commentsHourlyLimit', groupData.comments_hourly_limit);
    
    if (groupData.comments_per_post) {
        safeSetObjectValue('commentsPerPostMin', groupData.comments_per_post, 'min');
        safeSetObjectValue('commentsPerPostMax', groupData.comments_per_post, 'max');
    }
    
    if (groupData.comment_interval) {
        safeSetObjectValue('commentIntervalMin', groupData.comment_interval, 'min');
        safeSetObjectValue('commentIntervalMax', groupData.comment_interval, 'max');
    }
    
    if (groupData.comment_engagement) {
        if (groupData.comment_engagement.likes) {
            safeSetObjectValue('commentLikesMin', groupData.comment_engagement.likes, 'min');
            safeSetObjectValue('commentLikesMax', groupData.comment_engagement.likes, 'max');
        }
        if (groupData.comment_engagement.reposts) {
            safeSetObjectValue('commentRepostsMin', groupData.comment_engagement.reposts, 'min');
            safeSetObjectValue('commentRepostsMax', groupData.comment_engagement.reposts, 'max');
        }
        if (groupData.comment_engagement.views) {
            safeSetObjectValue('commentViewsMin', groupData.comment_engagement.views, 'min');
            safeSetObjectValue('commentViewsMax', groupData.comment_engagement.views, 'max');
        }
    }
    
    safeSetValue('commentPrompt', groupData.comment_prompt);
    
    // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ—Å—Ç—ñ–≤
    if (groupData.use_reposts !== undefined) {
        safeSetValue('useReposts', groupData.use_reposts ? 'yes' : 'no');
        toggleRepostSettings(); // –û–Ω–æ–≤–ª—é—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å –ø–æ–ª—ñ–≤
    }
    safeSetValue('repostPercentage', groupData.repost_percentage);
    safeSetValue('repostPrompt', groupData.repost_prompt);
    
    // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Å—Ç—ñ–≤
    if (groupData.use_posts !== undefined) {
        safeSetValue('usePosts', groupData.use_posts ? 'yes' : 'no');
        togglePostSettings(); // –û–Ω–æ–≤–ª—é—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å –ø–æ–ª—ñ–≤
    }
    safeSetValue('postPercentage', groupData.post_percentage);
    safeSetValue('postPrompt', groupData.post_prompt);
}

// –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤
function setupAdditionalHandlers() {
    console.log('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤...');
    
    // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –ø–æ–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫
    const useImages = document.getElementById('useImages');
    if (useImages) {
        useImages.addEventListener('change', toggleImagesFolder);
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω
        toggleImagesFolder();
    }
    
    // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –ø–æ–ª—è —Ä–µ–ø–æ—Å—Ç—ñ–≤
    const useReposts = document.getElementById('useReposts');
    if (useReposts) {
        useReposts.addEventListener('change', toggleRepostSettings);
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω
        toggleRepostSettings();
    }
    
    // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –ø–æ–ª—è –ø–æ—Å—Ç—ñ–≤
    const usePosts = document.getElementById('usePosts');
    if (usePosts) {
        usePosts.addEventListener('change', togglePostSettings);
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω
        togglePostSettings();
    }
    
    // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤ –∑ —á–∏—Å–ª–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏
    const numericFields = [
        'delayBetweenActionsMin', 'delayBetweenActionsMax',
        'delayBetweenLikesMin', 'delayBetweenLikesMax',
        'delayBetweenRetweetsMin', 'delayBetweenRetweetsMax',
        'delayBetweenCommentsMin', 'delayBetweenCommentsMax',
        'delayBetweenPostsMin', 'delayBetweenPostsMax',
        'minFollowers', 'minLikes', 'minReposts', 'minReplies',
        'searchHours', 'commentsTotalLimit', 'commentsDailyLimit',
        'commentsHourlyLimit', 'commentsPerPostMin', 'commentsPerPostMax',
        'commentIntervalMin', 'commentIntervalMax', 'commentLikesMin',
        'commentLikesMax', 'commentRepostsMin', 'commentRepostsMax',
        'commentViewsMin', 'commentViewsMax', 'repostPercentage',
        'postPercentage'
    ];
    
    numericFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
            field.addEventListener('input', function() {
                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —î —Ü—ñ–ª–∏–º —á–∏—Å–ª–æ–º
                const value = this.value;
                if (value && !/^\d+$/.test(value)) {
                    this.value = value.replace(/\D/g, '');
                }
            });
        }
    });
}

// –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ñ–æ—Ä–º–∏
function setupFormValidation() {
    console.log('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ñ–æ—Ä–º–∏...');
    
    const form = document.getElementById('groupForm');
    if (!form) {
        console.error('–§–æ—Ä–º–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞!');
        return;
    }
    
    // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó submit —è–∫ –∑–∞–ø–∞—Å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
    const submitHandler = async function(e) {
        e.preventDefault();
        console.log('–§–æ—Ä–º–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ submit –æ–±—Ä–æ–±–Ω–∏–∫!');
        
        // –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
        if (isSubmitting) {
            console.log('–§–æ—Ä–º–∞ –≤–∂–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è, —ñ–≥–Ω–æ—Ä—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç');
            return;
        }
        
        await handleFormSubmit();
    };
    
    // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ submit
    form.addEventListener('submit', submitHandler);
    
    // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ —á–µ—Ä–µ–∑ onsubmit —è–∫ –∑–∞–ø–∞—Å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
    form.onsubmit = submitHandler;
    
    console.log('–í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ñ–æ—Ä–º–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞, –æ–±—Ä–æ–±–Ω–∏–∫ submit –¥–æ–¥–∞–Ω–æ');
    
    console.log('–í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ñ–æ—Ä–º–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞');
}

// –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ñ–æ—Ä–º–∏
function validateForm() {
    console.log('–ü–æ—á–∞—Ç–æ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ñ–æ—Ä–º–∏...');
    
    const form = document.getElementById('groupForm');
    if (!form) {
        console.error('–§–æ—Ä–º–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó!');
        return false;
    }
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –≤—Å—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ
    if (!form.checkValidity()) {
        console.log('–ë–∞–∑–æ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è HTML –Ω–µ –ø—Ä–æ–π—à–ª–∞');
        form.reportValidity();
        return false;
    }
    
    console.log('–ë–∞–∑–æ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è HTML –ø—Ä–æ–π—à–ª–∞');
    
    // –ë–µ–∑–ø–µ—á–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —á–∏—Å–ª–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
    const safeValidateRange = (minFieldId, maxFieldId, fieldName) => {
        const minElement = document.getElementById(minFieldId);
        const maxElement = document.getElementById(maxFieldId);
        
        if (!minElement || !maxElement) {
            console.error(`–ï–ª–µ–º–µ–Ω—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: ${minFieldId} –∞–±–æ ${maxFieldId}`);
            showNotification(`–ü–æ–º–∏–ª–∫–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó: –µ–ª–µ–º–µ–Ω—Ç ${minFieldId} –∞–±–æ ${maxFieldId} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ`, 'error');
            return false;
        }
        
        const min = parseInt(minElement.value);
        const max = parseInt(maxElement.value);
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —î —Ü—ñ–ª–∏–º–∏ —á–∏—Å–ª–∞–º–∏
        if (isNaN(min) || isNaN(max)) {
            showNotification(`–ó–Ω–∞—á–µ–Ω–Ω—è –º–∞—é—Ç—å –±—É—Ç–∏ —Ü—ñ–ª–∏–º–∏ —á–∏—Å–ª–∞–º–∏ –¥–ª—è ${fieldName}`, 'error');
            return false;
        }
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ —î –≤—ñ–¥'—î–º–Ω–∏–º–∏
        if (min < 0 || max < 0) {
            showNotification(`–ó–Ω–∞—á–µ–Ω–Ω—è –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥'—î–º–Ω–∏–º–∏ –¥–ª—è ${fieldName}`, 'error');
            return false;
        }
        
        // –î–ª—è –∑–∞—Ç—Ä–∏–º–æ–∫: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –º–∞—î –±—É—Ç–∏ –º–µ–Ω—à–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ
        if (minFieldId.includes('delay')) {
            if (min >= max) {
                showNotification(`–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –º–∞—î –±—É—Ç–∏ –º–µ–Ω—à–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–ª—è ${fieldName}`, 'error');
                return false;
            }
        } else {
            // –î–ª—è –¥—ñ–π: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –º–∞—î –±—É—Ç–∏ –º–µ–Ω—à–µ –∞–±–æ –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É
            if (min > max) {
                showNotification(`–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –º–∞—î –±—É—Ç–∏ –º–µ–Ω—à–µ –∞–±–æ –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –¥–ª—è ${fieldName}`, 'error');
                return false;
            }
        }
        
        return true;
    };
    
    // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞—Ç—Ä–∏–º–æ–∫
    const delays = [
        ['delayBetweenActionsMin', 'delayBetweenActionsMax', '–∑–∞—Ç—Ä–∏–º–æ–∫ –º—ñ–∂ –¥—ñ—è–º–∏'],
        ['delayBetweenLikesMin', 'delayBetweenLikesMax', '–∑–∞—Ç—Ä–∏–º–æ–∫ –º—ñ–∂ –ª–∞–π–∫–∞–º–∏'],
        ['delayBetweenRetweetsMin', 'delayBetweenRetweetsMax', '–∑–∞—Ç—Ä–∏–º–æ–∫ –º—ñ–∂ —Ä–µ—Ç–≤—ñ—Ç–∞–º–∏'],
        ['delayBetweenCommentsMin', 'delayBetweenCommentsMax', '–∑–∞—Ç—Ä–∏–º–æ–∫ –º—ñ–∂ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏'],
        ['delayBetweenPostsMin', 'delayBetweenPostsMax', '–∑–∞—Ç—Ä–∏–º–æ–∫ –º—ñ–∂ –ø–æ—Å—Ç–∞–º–∏']
    ];
    
    // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞—Ç—Ä–∏–º–æ–∫
    for (const [minField, maxField, fieldName] of delays) {
        if (!safeValidateRange(minField, maxField, fieldName)) {
            return false;
        }
    }
    
    console.log('–í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ñ–æ—Ä–º–∏ –ø—Ä–æ–π—à–ª–∞ —É—Å–ø—ñ—à–Ω–æ');
    return true;
}

// –ó–±—ñ—Ä –¥–∞–Ω–∏—Ö –∑ —Ñ–æ—Ä–º–∏
function collectFormData() {
    console.log('–ó–±—ñ—Ä –¥–∞–Ω–∏—Ö –∑ —Ñ–æ—Ä–º–∏...');
    
    try {
        const groupNameElement = document.getElementById('groupName');
        const accountsSheetElement = document.getElementById('accountsGoogleSheet');
        const logsSheetElement = document.getElementById('logsGoogleSheet');
        
        if (!groupNameElement || !accountsSheetElement || !logsSheetElement) {
            throw new Error('–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è —Ñ–æ—Ä–º–∏');
        }
        
        const data = {
            group_name: groupNameElement.value,
            accounts_google_sheet: accountsSheetElement.value,
            logs_google_sheet: logsSheetElement.value,

            delays: {
                between_actions: {
                    min: parseInt(document.getElementById('delayBetweenActionsMin').value) || 30,
                    max: parseInt(document.getElementById('delayBetweenActionsMax').value) || 60
                },
                between_likes: {
                    min: parseInt(document.getElementById('delayBetweenLikesMin').value) || 15,
                    max: parseInt(document.getElementById('delayBetweenLikesMax').value) || 45
                },
                between_retweets: {
                    min: parseInt(document.getElementById('delayBetweenRetweetsMin').value) || 60,
                    max: parseInt(document.getElementById('delayBetweenRetweetsMax').value) || 180
                },
                between_comments: {
                    min: parseInt(document.getElementById('delayBetweenCommentsMin').value) || 90,
                    max: parseInt(document.getElementById('delayBetweenCommentsMax').value) || 240
                },
                between_posts: {
                    min: parseInt(document.getElementById('delayBetweenPostsMin').value) || 300,
                    max: parseInt(document.getElementById('delayBetweenPostsMax').value) || 600
                }
            },
            actions_per_run: {
                likes: {
                    min: 5,
                    max: 10
                },
                retweets: {
                    min: 2,
                    max: 7
                },
                comments: {
                    min: 2,
                    max: 6
                },
                posts: {
                    min: 1,
                    max: 1
                }
            },
            search_keywords: document.getElementById('searchKeywords').value.split(',').map(k => k.trim()).filter(k => k),
            post_topics: document.getElementById('postTopics').value.split(',').map(t => t.trim()).filter(t => t),
            
            // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ö–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–∞ –ø–æ—à—É–∫
            use_images: document.getElementById('useImages').value === 'yes',
            images_folder: document.getElementById('imagesFolder').value || '',
            search_format: document.getElementById('searchFormat').value,
            
            // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –§—ñ–ª—å—Ç—Ä–∏ –ø–æ—à—É–∫—É
            min_followers: parseInt(document.getElementById('minFollowers').value) || 1000,
            min_likes: parseInt(document.getElementById('minLikes').value) || 5,
            min_reposts: parseInt(document.getElementById('minReposts').value) || 2,
            min_replies: parseInt(document.getElementById('minReplies').value) || 1,
            search_hours: parseInt(document.getElementById('searchHours').value) || 24,
            
            // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤
            comments_total_limit: parseInt(document.getElementById('commentsTotalLimit').value) || 2000,
            comments_daily_limit: parseInt(document.getElementById('commentsDailyLimit').value) || 100,
            comments_hourly_limit: parseInt(document.getElementById('commentsHourlyLimit').value) || 10,
            comments_per_post: {
                min: parseInt(document.getElementById('commentsPerPostMin').value) || 1,
                max: parseInt(document.getElementById('commentsPerPostMax').value) || 3
            },
            comment_interval: {
                min: parseInt(document.getElementById('commentIntervalMin').value) || 15,
                max: parseInt(document.getElementById('commentIntervalMax').value) || 30
            },
            comment_engagement: {
                likes: {
                    min: parseInt(document.getElementById('commentLikesMin').value) || 1,
                    max: parseInt(document.getElementById('commentLikesMax').value) || 3
                },
                reposts: {
                    min: parseInt(document.getElementById('commentRepostsMin').value) || 2,
                    max: parseInt(document.getElementById('commentRepostsMax').value) || 5
                },
                views: {
                    min: parseInt(document.getElementById('commentViewsMin').value) || 55,
                    max: parseInt(document.getElementById('commentViewsMax').value) || 100
                }
            },
            comment_prompt: document.getElementById('commentPrompt').value,
            
            // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ—Å—Ç—ñ–≤
            use_reposts: document.getElementById('useReposts').value === 'yes',
            repost_percentage: parseInt(document.getElementById('repostPercentage').value) || 50,
            repost_prompt: document.getElementById('repostPrompt').value,
            
            // –ù–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Å—Ç—ñ–≤
            use_posts: document.getElementById('usePosts').value === 'yes',
            post_percentage: parseInt(document.getElementById('postPercentage').value) || 50,
            post_prompt: document.getElementById('postPrompt').value
        };
        
        console.log('–î–∞–Ω—ñ –∑—ñ–±—Ä–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ:', data);
        console.log('–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø–æ–ª—ñ–≤:');
        console.log('- group_name:', data.group_name);
        console.log('- accounts_google_sheet:', data.accounts_google_sheet);
        console.log('- logs_google_sheet:', data.logs_google_sheet);
        console.log('- search_keywords:', data.search_keywords);
        console.log('- post_topics:', data.post_topics);
        console.log('- use_images:', data.use_images);
        console.log('- search_format:', data.search_format);
        console.log('- min_followers:', data.min_followers);
        console.log('- comments_total_limit:', data.comments_total_limit);
        console.log('- use_reposts:', data.use_reposts);
        console.log('- use_posts:', data.use_posts);
        return data;
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–±–æ—Ä—É –¥–∞–Ω–∏—Ö –∑ —Ñ–æ—Ä–º–∏:', error);
        throw new Error('–ü–æ–º–∏–ª–∫–∞ –∑–±–æ—Ä—É –¥–∞–Ω–∏—Ö –∑ —Ñ–æ—Ä–º–∏: ' + error.message);
    }
}

// –ó–∞–ø—É—Å–∫ –≥—Ä—É–ø–∏
async function startGroup(groupName) {
    try {
        const response = await fetch(`/api/shilling/groups/${encodeURIComponent(groupName)}/start`, {
            method: 'POST'
        });
        
        if (response.ok) {
            showNotification(`–ü—Ä–æ—î–∫—Ç '${groupName}' –∑–∞–ø—É—â–µ–Ω–∞`, 'success');
            loadGroups();
        } else {
            const error = await response.json();
            showNotification(error.message || '–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ—î–∫—Ç—É', 'error');
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ—î–∫—Ç—É:', error);
        showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ—î–∫—Ç—É', 'error');
    }
}

// –ó—É–ø–∏–Ω–∫–∞ –≥—Ä—É–ø–∏
async function stopGroup(groupName) {
    try {
        const response = await fetch(`/api/shilling/groups/${encodeURIComponent(groupName)}/stop`, {
            method: 'POST'
        });
        
        if (response.ok) {
            showNotification(`–ü—Ä–æ—î–∫—Ç '${groupName}' –∑—É–ø–∏–Ω–µ–Ω–∞`, 'success');
            loadGroups();
        } else {
            const error = await response.json();
            showNotification(error.message || '–ü–æ–º–∏–ª–∫–∞ –∑—É–ø–∏–Ω–∫–∏ –ø—Ä–æ—î–∫—Ç—É', 'error');
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑—É–ø–∏–Ω–∫–∏ –ø—Ä–æ—î–∫—Ç—É:', error);
        showNotification('–ü–æ–º–∏–ª–∫–∞ –∑—É–ø–∏–Ω–∫–∏ –ø—Ä–æ—î–∫—Ç—É', 'error');
    }
}

// –í–∏–¥–∞–ª–µ–Ω–Ω—è –≥—Ä—É–ø–∏
async function deleteGroup(groupName) {
    if (!confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç '${groupName}'?`)) {
        return;
    }
    
    try {
        const response = await fetch(`/api/shilling/groups/${encodeURIComponent(groupName)}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
            showNotification(`–ü—Ä–æ—î–∫—Ç '${groupName}' –≤–∏–¥–∞–ª–µ–Ω–∞`, 'success');
                    loadGroups();
                } else {
            const error = await response.json();
            showNotification(error.message || '–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É', 'error');
                }
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É:', error);
                showNotification('–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É', 'error');
            }
}

// –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤ –≥—Ä—É–ø–∏
async function viewGroupLogs(groupName) {
    try {
        console.log(`üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤ –ø—Ä–æ—î–∫—Ç—É: ${groupName}`);
        
        // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        showLoadingIndicator(`–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤: ${groupName}`);
        
        // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Promise.race –¥–ª—è —Ç–∞–π–º–∞—É—Ç—É
        const timeoutPromise = new Promise((_, reject) => 
            setTimeout(() => reject(new Error('Timeout')), 10000)
        );
        
        const fetchPromise = fetch(`/api/shilling/groups/${encodeURIComponent(groupName)}`);
        
        const response = await Promise.race([fetchPromise, timeoutPromise]);
        
        if (response.ok) {
            const groupData = await response.json();
            displayGroupLogs(groupName, groupData);
            document.getElementById('logsModal').style.display = 'block';
            
            console.log(`‚úÖ –ó–≤—ñ—Ç–∏ –ø—Ä–æ—î–∫—Ç—É ${groupName} —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ`);
            showNotification(`–ó–≤—ñ—Ç–∏ –ø—Ä–æ—î–∫—Ç—É ${groupName} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ`, 'success');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –≥—Ä—É–ø–∏ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            setTimeout(() => refreshGroupStatus(groupName), 500);
        } else {
            const errorData = await response.json();
            throw new Error(errorData.error || '–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤ –ø—Ä–æ—î–∫—Ç—É');
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤ –ø—Ä–æ—î–∫—Ç—É:', error);
        
        if (error.message === 'Timeout') {
            showNotification('–¢–∞–π–º–∞—É—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.', 'warning');
        } else {
            showNotification(`–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–≤—ñ—Ç—ñ–≤: ${error.message}`, 'error');
        }
    } finally {
        // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        hideLoadingIndicator();
    }
}

// –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ç–∞–±–ª–∏—Ü—é –ª–æ–≥—ñ–≤ –≥—Ä—É–ø–∏
function displayGroupLogs(groupName, groupData) {
    document.getElementById('logsModalTitle').textContent = `–ó–≤—ñ—Ç–∏ –ø—Ä–æ—î–∫—Ç—É: ${groupName}`;
    
    // –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ç–∞–±–ª–∏—Ü—é –ª–æ–≥—ñ–≤
    const logsSheetLink = document.getElementById('logsSheetLink');
    const logsGoogleSheet = groupData.logs_google_sheet;
    
    if (logsGoogleSheet) {
        logsSheetLink.href = logsGoogleSheet;
        logsSheetLink.style.display = 'inline-block';
    } else {
        logsSheetLink.style.display = 'none';
        showNotification('–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ç–∞–±–ª–∏—Ü—é –∑–≤—ñ—Ç—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ', 'warning');
    }
}

// –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –ª–æ–≥—ñ–≤
function closeLogsModal() {
    document.getElementById('logsModal').style.display = 'none';
}

// –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–∞—Ç–∏
function formatDate(dateString) {
    if (!dateString) return '–ù–µ–≤—ñ–¥–æ–º–æ';
    
    try {
        const date = new Date(dateString);
        return date.toLocaleString('uk-UA');
    } catch (error) {
        return dateString;
    }
}

// –ü–æ–∫–∞–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
function showNotification(message, type = 'info') {
    // –°—Ç–≤–æ—Ä—é—î–º–æ –µ–ª–µ–º–µ–Ω—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.innerHTML = `
        <div class="notification-content">
            <i class="fas fa-${getNotificationIcon(type)}"></i>
            <span>${message}</span>
        </div>
        <button class="notification-close" onclick="this.parentElement.remove()" title="–ó–∞–∫—Ä–∏—Ç–∏">&times;</button>
    `;
    
    // –î–æ–¥–∞—î–º–æ –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    document.body.appendChild(notification);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª—è—î–º–æ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ (–∑–±—ñ–ª—å—à–µ–Ω–æ –∑ 5 –¥–æ 10)
    setTimeout(() => {
        if (notification.parentElement) {
            notification.remove();
        }
    }, 10000);
    
    // –õ–æ–≥—É—î–º–æ –≤ –∫–æ–Ω—Å–æ–ª—å
    console.log(`${type.toUpperCase()}: ${message}`);
}

// –û—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–∫–æ–Ω–∫–∏ –¥–ª—è —Ç–∏–ø—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
function getNotificationIcon(type) {
    switch (type) {
        case 'success': return 'check-circle';
        case 'error': return 'exclamation-circle';
        case 'warning': return 'exclamation-triangle';
        case 'info': 
        default: return 'info-circle';
    }
}

// –û–±—Ä–æ–±–Ω–∏–∫ –∫–ª—ñ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É submit
function handleSubmitClick() {
    console.log('–ö–Ω–æ–ø–∫–∞ submit –Ω–∞—Ç–∏—Å–Ω—É—Ç–∞ —á–µ—Ä–µ–∑ onclick');
    
    // –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
    if (isSubmitting) {
        console.log('–§–æ—Ä–º–∞ –≤–∂–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è, —ñ–≥–Ω–æ—Ä—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç');
        return;
    }
    
    // –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ñ–æ—Ä–º—É
    const form = document.getElementById('groupForm');
    if (!form) {
        console.error('–§–æ—Ä–º–∞ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞ –≤ handleSubmitClick!');
        return;
    }
    
    console.log('–§–æ—Ä–º–∞ –∑–Ω–∞–π–¥–µ–Ω–∞ –≤ handleSubmitClick:', form);
    
    // –¢—Ä–∏–≥–µ—Ä–∏–º–æ submit —Ñ–æ—Ä–º–∏
    try {
        form.dispatchEvent(new Event('submit', { bubbles: true, cancelable: true }));
        console.log('Submit –ø–æ–¥—ñ—è —Ç—Ä–∏–≥–µ—Ä–µ–Ω–∞');
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ —Ç—Ä–∏–≥–µ—Ä—É submit –ø–æ–¥—ñ—ó:', error);
        
        // –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è —Ç—Ä–∏–≥–µ—Ä–∏—Ç–∏ –ø–æ–¥—ñ—é, –≤–∏–∫–ª–∏–∫–∞—î–º–æ –æ–±—Ä–æ–±–∫—É –≤—Ä—É—á–Ω—É
        console.log('–°–ø—Ä–æ–±–∞ –æ–±—Ä–æ–±–∫–∏ —Ñ–æ—Ä–º–∏ –≤—Ä—É—á–Ω—É...');
        handleFormSubmit();
    }
}

// –û–±—Ä–æ–±–∫–∞ —Ñ–æ—Ä–º–∏ –≤—Ä—É—á–Ω—É
async function handleFormSubmit() {
    console.log('–û–±—Ä–æ–±–∫–∞ —Ñ–æ—Ä–º–∏ –≤—Ä—É—á–Ω—É...');
    
    // –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
    if (isSubmitting) {
        console.log('–§–æ—Ä–º–∞ –≤–∂–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è, —ñ–≥–Ω–æ—Ä—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç');
        return;
    }
    
    if (!validateForm()) {
        console.log('–í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–µ –ø—Ä–æ–π—à–ª–∞');
        return;
    }
    
    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ñ–ª–∞–≥ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
    isSubmitting = true;
    
    // –ë–ª–æ–∫—É—î–º–æ –∫–Ω–æ–ø–∫—É submit
    const submitButton = document.querySelector('#groupModal button[type="submit"]');
    if (submitButton) {
        submitButton.disabled = true;
        submitButton.textContent = '–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è...';
    }
    
    try {
        console.log('–í–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—Ä–æ–π—à–ª–∞, –∑–±–∏—Ä–∞—î–º–æ –¥–∞–Ω—ñ...');
        const formData = collectFormData();
        console.log('–î–∞–Ω—ñ —Ñ–æ—Ä–º–∏:', formData);
        
        const url = currentEditingGroup 
            ? `/api/shilling/groups/${encodeURIComponent(currentEditingGroup)}`
            : '/api/shilling/groups';
        
        const method = currentEditingGroup ? 'PUT' : 'POST';
        
        console.log(`–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ ${method} –∑–∞–ø–∏—Ç –Ω–∞ ${url}`);
        
        const response = await fetch(url, {
            method: method,
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        });
        
        console.log('–û—Ç—Ä–∏–º–∞–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:', response.status, response.statusText);
        
        if (response.ok) {
            const result = await response.json();
            console.log('–£—Å–ø—ñ—à–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:', result);
            showNotification(
                currentEditingGroup ? '–ü—Ä–æ—î–∫—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ' : '–ü—Ä–æ—î–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ', 
                'success'
            );
            closeGroupModal();
            loadGroups();
        } else {
            const error = await response.json();
            console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:', error);
            showNotification(error.message || '–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É', 'error');
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É:', error);
        showNotification('–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É: ' + error.message, 'error');
    } finally {
        // –°–∫–∏–¥–∞—î–º–æ —Ñ–ª–∞–≥ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
        isSubmitting = false;
        
        // –†–æ–∑–±–ª–æ–∫–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É submit
        if (submitButton) {
            submitButton.disabled = false;
            submitButton.textContent = currentEditingGroup ? '–û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç' : '–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç';
        }
    }
}

// –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º–∏
window.onclick = function(event) {
    const groupModal = document.getElementById('groupModal');
    const logsModal = document.getElementById('logsModal');
    
    if (event.target === groupModal) {
        closeGroupModal();
    }
    
    if (event.target === logsModal) {
        closeLogsModal();
    }
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫–∞–∑—É —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
function showLoadingIndicator(message) {
    // –°—Ç–≤–æ—Ä—é—î–º–æ –∞–±–æ –æ–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    let loadingIndicator = document.getElementById('loadingIndicator');
    
    if (!loadingIndicator) {
        loadingIndicator = document.createElement('div');
        loadingIndicator.id = 'loadingIndicator';
        loadingIndicator.className = 'loading-indicator';
        loadingIndicator.innerHTML = `
            <div class="loading-content">
                <div class="spinner"></div>
                <span class="loading-text">${message}</span>
            </div>
        `;
        document.body.appendChild(loadingIndicator);
    } else {
        loadingIndicator.querySelector('.loading-text').textContent = message;
    }
    
    loadingIndicator.style.display = 'flex';
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
function hideLoadingIndicator() {
    const loadingIndicator = document.getElementById('loadingIndicator');
    if (loadingIndicator) {
        loadingIndicator.style.display = 'none';
    }
}

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –æ–±–≥–æ—Ä—Ç–∫–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ–π (–∑–∞–ø—É—Å–∫–∞—é—Ç—å –≤ background)
function viewGroupLogsAsync(groupName) {
    // –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ background –±–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI
    setTimeout(() => viewGroupLogs(groupName), 0);
}

function editGroupAsync(groupName) {
    // –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ background –±–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI
    setTimeout(() => editGroup(groupName), 0);
}

// –û–Ω–æ–≤–ª—é—î–º–æ –∫–Ω–æ–ø–∫–∏ —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
function updateGroupButtons() {
    const buttons = document.querySelectorAll('.btn-info[onclick*="viewGroupLogs"]');
    buttons.forEach(button => {
        const groupName = button.getAttribute('onclick').match(/'([^']+)'/)[1];
        button.setAttribute('onclick', `viewGroupLogsAsync('${groupName}')`);
    });
    
    const editButtons = document.querySelectorAll('.btn-primary[onclick*="editGroup"]');
    editButtons.forEach(button => {
        const groupName = button.getAttribute('onclick').match(/'([^']+)'/)[1];
        button.setAttribute('onclick', `editGroupAsync('${groupName}')`);
    });
}

// –í–∏–∫–ª–∏–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–Ω–æ–ø–æ–∫ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    updateGroupButtons();
});

// –û–Ω–æ–≤–ª—é—î–º–æ –∫–Ω–æ–ø–∫–∏ –ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –≥—Ä—É–ø
function refreshGroupsList() {
    // ... existing code ...
    
    // –ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –æ–Ω–æ–≤–ª—é—î–º–æ –∫–Ω–æ–ø–∫–∏
    setTimeout(updateGroupButtons, 100);
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å—É –≥—Ä—É–ø–∏
async function refreshGroupStatus(groupName) {
    try {
        const response = await fetch(`/api/shilling/groups/${encodeURIComponent(groupName)}/status`);
        if (response.ok) {
            const statusData = await response.json();
            updateGroupStatusDisplay(groupName, statusData);
        }
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –ø—Ä–æ—î–∫—Ç—É:', error);
    }
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –≥—Ä—É–ø–∏
function updateGroupStatusDisplay(groupName, statusData) {
    const groupCard = document.querySelector(`[data-group-name="${groupName}"]`);
    if (!groupCard) return;
    
    const statusElement = groupCard.querySelector('.group-status');
    const toggleButton = groupCard.querySelector('.btn-sm');
    
    if (statusElement && toggleButton) {
        const isRunning = statusData.is_running;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å
        statusElement.className = `group-status ${isRunning ? 'status-running' : 'status-stopped'}`;
        statusElement.innerHTML = `
            <i class="fas fa-${isRunning ? 'play' : 'stop'}"></i>
            ${isRunning ? '–ó–∞–ø—É—â–µ–Ω–∞' : '–ó—É–ø–∏–Ω–µ–Ω–∞'}
        `;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –∫–Ω–æ–ø–∫—É
        toggleButton.className = `btn btn-sm ${isRunning ? 'btn-warning' : 'btn-success'}`;
        toggleButton.onclick = () => toggleGroup(groupName, isRunning);
        toggleButton.innerHTML = `
            <i class="fas fa-${isRunning ? 'pause' : 'play'}"></i>
            ${isRunning ? '–ó—É–ø–∏–Ω–∏—Ç–∏' : '–ó–∞–ø—É—Å—Ç–∏—Ç–∏'}
        `;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ –∫–ª–∞—Å –∫–∞—Ä—Ç–∫–∏
        groupCard.className = `group-card ${isRunning ? 'running' : 'stopped'}`;
    }
}

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –≤—Å—ñ—Ö –≥—Ä—É–ø
function startStatusRefresh() {
    // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥
    setInterval(() => {
        if (groupsData && groupsData.length > 0) {
            groupsData.forEach(group => {
                refreshGroupStatus(group.group_name);
            });
        }
    }, 30000);
}

// –ó–∞–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
document.addEventListener('DOMContentLoaded', function() {
    updateGroupButtons();
    
    // –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
    setTimeout(startStatusRefresh, 5000);
});
</script>
{% endblock %}
